<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Terms and Conditions | Yunoxa</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="termsandconditions terms for Yunoxa - Sri Lanka's Best Online Shopping Platform" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            --yunoxa-red: #e02f2f;
            --yunoxa-dark-red: #c41e1e;
            --yunoxa-yellow: #ffd700;
            --yunoxa-orange: #ff9500;
            --yunoxa-blue: #2e8bff;
            --yunoxa-bg: #f8f8f8;
            --yunoxa-text: #333;
            --yunoxa-light-text: #666;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--yunoxa-bg);
            color: var(--yunoxa-text);
            line-height: 1.6;
            padding-bottom: 70px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .termsandconditions-header {
            text-align: center;
            padding: 30px 0;
        }
        
        .termsandconditions-header h1 {
            font-size: 36px;
            color: var(--yunoxa-red);
            margin-bottom: 15px;
        }
        
        .termsandconditions-header p {
            color: var(--yunoxa-light-text);
            font-size: 16px;
        }
        
        .termsandconditions-content {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .termsandconditions-section {
            margin-bottom: 30px;
        }
        
        .termsandconditions-section h2 {
            color: var(--yunoxa-red);
            font-size: 24px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .termsandconditions-section h3 {
            font-size: 18px;
            margin: 20px 0 10px;
            color: var(--yunoxa-text);
        }
        
        .termsandconditions-section p {
            margin-bottom: 15px;
            color: var(--yunoxa-light-text);
        }
        
        .terms-content {
            white-space: pre-line;
            word-wrap: break-word;
        }
        
        .terms-content ul,
        .terms-content ol {
            margin-bottom: 15px;
            color: var(--yunoxa-light-text);
            padding-left: 25px;
        }
        
        .terms-content li {
            margin-bottom: 10px;
            display: list-item;
            list-style-position: outside;
        }
        
        .terms-content ul {
            list-style-type: disc;
        }
        
        .terms-content ol {
            list-style-type: decimal;
        }
        
        .effective-date {
            font-style: italic;
            text-align: right;
            margin-top: 30px;
            color: var(--yunoxa-light-text);
        }

        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,.1);
            border-radius: 50%;
            border-top-color: var(--yunoxa-red);
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
            display: block;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--yunoxa-light-text);
            font-size: 12px;
        }

        .nav-item.active {
            color: var(--yunoxa-red);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 3px;
        }
        
        @media (max-width: 768px) {
            .termsandconditions-header h1 {
                font-size: 28px;
            }
            
            .termsandconditions-section h2 {
                font-size: 22px;
            }
            
            .termsandconditions-content {
                padding: 20px;
            }
            
            .terms-content ul,
            .terms-content ol {
                padding-left: 20px;
            }
        }

        /* Terms and Conditions Styling */
.terms-section {
  margin-bottom: 2rem;
  padding: 1.5rem;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.current-badge {
  color: var(--yunoxa-red);
  font-size: 0.8em;
  margin-left: 0.5em;
}

.effective-date {
  color: #666;
  font-style: italic;
  margin-bottom: 1rem;
}

.terms-content {
  line-height: 1.6;
}

.terms-content ul, .terms-content ol {
  margin: 1rem 0 1rem 2rem;
}

.terms-divider {
  border: 0;
  border-top: 1px dashed #eee;
  margin: 2rem 0;
}

.no-terms-message, .error-message {
  text-align: center;
  padding: 2rem;
  background: #f8f9fa;
  border-radius: 8px;
}

.contact-link {
  color: var(--yunoxa-red);
  text-decoration: none;
  font-weight: 500;
}

.error-detail {
  color: #dc3545;
  font-size: 0.9em;
}
    </style>
</head>

<body>
    <!-- Header -->
    <header class="termsandconditions-header">
        <div class="container">
            <h1><i class="fas fa-shield-alt"></i> Yunoxa  Terms and Conditions</h1>
            <p id="last-updated">Loading...</p>
        </div>
    </header>
    <div class="container">
        <div class="termsandconditions-content">
            <div class="termsandconditions-section" id="termsandconditions-content">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </div>
    
    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="index.html" class="nav-item">
            <i class="fas fa-home nav-icon"></i>
            <span>Home</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-search nav-icon"></i>
            <span>Search</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-gift nav-icon"></i>
            <span>Deals</span>
        </a>
        <a href="favorites.html" class="nav-item">
            <i class="fas fa-heart nav-icon"></i>
            <span>Favorites</span>
        </a>
    </nav>

    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';
        
        // Configuration
        const config = {
          supabaseUrl: 'https://qopdjgfciakmvhlriixt.supabase.co',
          workerUrl: 'https://yunoxapvt.yunoxa1.workers.dev/',
          elements: {
            content: 'termsandconditions-content',
            lastUpdated: 'last-updated',
            loading: 'loading-indicator'
          }
        };
        
        // Main Controller
        class TermsController {
          constructor() {
            this.supabase = null;
            this.init();
          }
        
          async init() {
            try {
              this.showLoading();
              this.supabase = await this.initializeSupabase();
              const termsData = await this.fetchTerms();
              this.renderTerms(termsData);
            } catch (error) {
              this.handleError(error);
            } finally {
              this.hideLoading();
            }
          }
        
          async initializeSupabase() {
            const tokenResponse = await fetch(config.workerUrl);
            if (!tokenResponse.ok) throw new Error('Token fetch failed');
            
            const supabaseKey = (await tokenResponse.text()).trim();
            const supabase = createClient(config.supabaseUrl, supabaseKey);
            
            // Verify connection
            const { error } = await supabase
              .from('products')
              .select('*')
              .limit(1);
              
            if (error) throw error;
            return supabase;
          }
        
          async fetchTerms() {
            const { data, error } = await this.supabase
              .from('termsandconditions')
              .select('*')
              .order('updated_at', { ascending: false });
        
            if (error) throw error;
            return data || [];
          }
        
          renderTerms(termsData) {
            if (!termsData.length) {
              this.showNoTermsMessage();
              return;
            }
        
            this.updateLastUpdated(termsData[0].updated_at);
            
            const html = termsData.map((terms, index) => `
              <div class="terms-section">
                <h2>${terms.title}${index === 0 ? this.currentVersionBadge() : ''}</h2>
                <p class="effective-date">Effective: ${this.formatDate(terms.updated_at)}</p>
                <div class="terms-content">${this.formatContent(terms.termsandconditions)}</div>
              </div>
              ${index < termsData.length - 1 ? '<hr class="terms-divider">' : ''}
            `).join('');
        
            document.getElementById(config.elements.content).innerHTML = html;
            this.formatLists();
          }
        
          // Helper methods
          formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            });
          }
        
          currentVersionBadge() {
            return '<span class="current-badge">(Current Version)</span>';
          }
        
          formatContent(content) {
            // Basic list formatting
            return content
              .replace(/\* (.*?)(\n|$)/g, '<ul><li>$1</li></ul>')
              .replace(/\d+\. (.*?)(\n|$)/g, '<ol><li>$1</li></ol>');
          }
        
          formatLists() {
            // Additional list formatting if needed
          }
        
          updateLastUpdated(dateString) {
            document.getElementById(config.elements.lastUpdated).textContent = 
              `Last updated: ${this.formatDate(dateString)}`;
          }
        
          showNoTermsMessage() {
            document.getElementById(config.elements.content).innerHTML = `
              <div class="no-terms-message">
                <h2>Terms and Conditions</h2>
                <p>Currently unavailable. Please check back later.</p>
                <a href="mailto:support@example.com" class="contact-link">Contact Support</a>
              </div>
            `;
          }
        
          handleError(error) {
            console.error('Error:', error);
            document.getElementById(config.elements.content).innerHTML = `
              <div class="error-message">
                <h2>Loading Error</h2>
                <p>We're unable to load the terms at this time.</p>
                <p class="error-detail">${error.message}</p>
                <a href="mailto:support@example.com" class="contact-link">Contact Support</a>
              </div>
            `;
          }
        
          showLoading() {
            // Implement loading indicator if you have one
          }
        
          hideLoading() {
            // Hide loading indicator
          }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => new TermsController());
        </script>
</body>
</html>